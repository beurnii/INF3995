stages:
    - build
    - test
    - lint

cache:
    paths:
        - server/build
        - desktop/build

################
# Build Stages #
################

build-server:
    stage: build
    image: rikorose/gcc-cmake
    script:
        - cd server && ./build.sh
        # - lint.sh &&./lint.sh tidy TODO add docker image

build-desktop:
    stage: build
    image: gradle:jdk12
    script:
        - cd desktop && gradle build

###############
# Test Stages #
###############

test-server:
    stage: test
    image: rikorose/gcc-cmake
    script:
        - cd server && echo "TODO"

test-desktop:
    stage: test
    image: gradle:jdk12
    script:
        - cd desktop && gradle test

###############
# Lint Stages #
###############

lint-server:
    stage: lint
    image: teeks99/clang-ubuntu
    script:
        - cd server && chmod + lint.sh && ./lint.sh format -8 # TODO remove chmod
